<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="apple-touch-icon" href="/html-preview/apple-touch-icon.png">
    <link rel="icon" href="/html-preview/apple-touch-icon.png">
    <title>HTML Preview</title>
    <style>
        /* 1. Ensure the body takes up the full screen height */
        html, body { 
            height: 100%; 
            margin: 0; 
            padding: 0; 
            overflow: hidden; /* Prevents outer page scrolling */
        }

        body { 
            font-family: -apple-system, system-ui, sans-serif; 
            background: #f4f4f7; 
            display: flex; 
            justify-content: center;
        }

        /* 2. Container uses 100dvh (Dynamic Viewport Height) */
        .container { 
            width: 100%; 
            max-width: 800px; 
            height: 100dvh; 
            display: flex; 
            flex-direction: column; 
            gap: 12px; 
            padding: 15px;
            box-sizing: border-box; /* Ensures padding doesn't add to height */
        }
        
        h2 { margin: 0; color: #333; font-size: 1.2rem; }

        /* 3. Textarea now "grows" to fill remaining space */
        textarea { 
            width: 100%; 
            flex: 1; /* This is the magic line */
            padding: 15px; 
            border: 1px solid #ced4da; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace; 
            font-size: 16px; /* Prevents iOS zoom on focus */
            box-sizing: border-box; 
            background: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            white-space: pre;
            overflow: auto;
            resize: none; /* Cleaner on mobile */
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding-bottom: 5px; /* Tiny buffer at the bottom */
        }

        button { 
            flex: 1; 
            min-width: 80px; 
            padding: 14px; 
            border: none; 
            border-radius: 8px; 
            font-weight: bold; 
            font-size: 1rem; 
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .btn-primary { background: #007bff; color: white; }
        .btn-secondary { background: #6c757d; color: white; }

        button:hover { opacity: 0.9; }
        button:active { transform: scale(0.98); }

        @media (max-width: 599px) {
            .btn-primary { flex: 1 1 100%; }
            .btn-secondary { flex: 1; }
        }

        @media (min-width: 600px) {
            button { flex: 0 1 auto; padding: 12px 30px; }
        }
    </style>
</head>
<body>

<div class="container">
    <h2>HTML Preview</h2>
    <textarea id="code-input" placeholder="Paste your HTML, CSS, and JS here..." autofocus></textarea>

    <div class="button-group">
        <button class="btn-primary" onclick="openPreview()">Open Preview</button>
        <button class="btn-secondary" onclick="pasteFromClipboard()">Paste</button>
        <button class="btn-secondary" onclick="copyToClipboard()">Copy</button>
    </div>
</div>

<script>
    let currentBlobURL = null;
    const codeArea = document.getElementById('code-input');

    function openPreview() {
        const code = codeArea.value;
        if (!code.trim()) {
            alert("Please enter some code first.");
            return;
        }
        if (currentBlobURL) {
            URL.revokeObjectURL(currentBlobURL);
        }
        const blob = new Blob([code], { type: 'text/html' });
        currentBlobURL = URL.createObjectURL(blob);
        const win = window.open(currentBlobURL, '_blank');
        if (!win) {
            alert("Pop-up blocked! Please allow pop-ups to open the preview.");
        }
    }

    async function pasteFromClipboard() {
        try {
            const text = await navigator.clipboard.readText();
            codeArea.value = text;
        } catch (err) {
            alert("Please use Cmd+V / Ctrl+V or grant permission.");
        }
    }

    function copyToClipboard() {
        const code = codeArea.value;
        if (!code) return;
        navigator.clipboard.writeText(code).then(() => {
            alert("Code copied!");
        }).catch(err => {
            alert("Failed to copy.");
        });
    }
</script>

</body>
</html>
